sequenceDiagram
    participant Client
    participant API as /api/budgets
    participant AuthorizationMiddleware
    participant Db as FinancetrackerContext
    participant Helpers as BudgetHelpers

    Client->>API: POST /api/budgets { categoryId?, amount, startDate?, endDate? }
    API->>AuthorizationMiddleware: validate token
    AuthorizationMiddleware-->>API: userId
    API->>Helpers: ValidateCategoryExistsAsync(categoryId, db, userId)
    Helpers-->>API: valid/invalid
    API->>Db: INSERT Budget
    Db-->>API: budget created
    API->>Helpers: NormalizeRangeForResponse(startDate,endDate)
    Helpers-->>API: normalized
    API-->>Client: 201 Created { budget }
